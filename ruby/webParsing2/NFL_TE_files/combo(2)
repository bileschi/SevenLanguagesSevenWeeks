if(typeof YAHOO==="undefined"){var YAHOO={}}if(typeof YAHOO.ads==="undefined"){YAHOO.ads={}}YAHOO.ads.darla={_beacons:[],_eventTimer:null,_lastEvent:null,_handoffStore:null,_renderStore:null,_rotationTimer:null,_rotationTime:(new Date()).getTime(),_rotationEvents:false,_config:null,_baseConfig:{callFrame:"fccall",callScript:"/darla/fc.php",rotation:5000,autoRotation:false,autoRotationWindow:1000,cancelShortEvents:true,doubleBuffering:true,autoSwitchRendering:true,property:"yahoo",encoding:"utf-8",standardDelay:100,cancellableDelay:500,beaconDelay:2000,beaconUrl:"http://geo.yahoo.com/serv?s=",beaconType:"geo",throbberDelay:350,simpleTemplate:"<html><head><!--ENCODING--><base target='_blank' /><!--STYLE--></head><body style='overflow:hidden;'><table width='100%' cellspacing='0' cellpadding='0'><tr><td align=center valign=top><!--ADHTML--></td></tr></table></body></html>",simpleTemplateEncodingTag:"<meta http-equiv='Content-Type' content='text/html;charset=__ENCODING__'>",simpleTemplateStyleTag:"<style> body { background-color: __BGCOLOR__; } </style>"},setConfig:function(B,A){YAHOO.ads.darla._config=B;if(A===0){YAHOO.ads.darla._config._startRotationTimer()}},event:function(B,C){if(YAHOO.ads.darla._config==null){return }if(YAHOO.ads.darla._prefetchStore){YAHOO.ads.darla.log("Ignoring the darla event["+B+"] called before prefetched ads are rendered!");return }var A=YAHOO.ads.darla.lookupActionSettings(B,C);YAHOO.ads.darla.log("YAHOO.ads.darla.event called with action: "+B+"-"+YAHOO.ads.darla.lookupSpaceID(B),true);if((A.lv==-1)&&!YAHOO.ads.darla.getConfigSetting("autoRotation")){return }if(YAHOO.ads.darla._eventTimer!=null){if((YAHOO.ads.darla.getConfigSetting("cancelShortEvents")==true)||(YAHOO.ads.darla._lastEvent&&YAHOO.ads.darla._lastEvent.settings&&YAHOO.ads.darla._lastEvent.settings.ca)){clearTimeout(YAHOO.ads.darla._eventTimer);YAHOO.ads.darla._eventTimer=null;YAHOO.ads.darla.log("YAHOO.ads.darla.event: cancelling prior short-lived event",true)}}YAHOO.ads.darla.log("YAHOO.ads.darla.event firing timer for action: "+B+"-"+A.sp,true);YAHOO.ads.darla._lastEvent={action:B,settings:A};YAHOO.ads.darla._startEventTimer(YAHOO.ads.darla._lastEvent)},renderPrefetchAds:function(){function F(){var K="darla_prefetch_csc_cont";var L=document.getElementById(K);if(L){return L}L=document.createElement("div");L.setAttribute("id",K);L.style.display="none";document.getElementsByTagName("body")[0].appendChild(L);return L}if(typeof YAHOO.ads.renderer==="undefined"||typeof YAHOO.ads.renderer.ComplexRenderer==="undefined"){YAHOO.ads.darla.log("Error: ComplexRenderer required for rendering prefetched ads");return }var B=YAHOO.ads.darla._prefetchStore;if(B===null){YAHOO.ads.darla.log("No prefetched ads to render.");return }var H="",I="";for(var E in B){if(B.hasOwnProperty(E)){var J=B[E];for(var D=0;D<J.length;++D){if(YAHOO.ads.darla._handoff(E,J[D].adHtml)==true){H+=J[D].csc;if(window.emitted!=null){if(I.length>0){I+=","}I+=E}}}}}H+=YAHOO.ads.darla._end_of_page_js;try{YAHOO.ads.darla._loaded(I)}catch(G){YAHOO.ads.darla.log("Error while rendering prefetched ads : "+(G.message||G))}var A=YAHOO.ads.darla._fetchRendererOptions();var C=YAHOO.ads.renderer.ComplexRenderer;C.registerPostRenderCallback(this,function(){YAHOO.ads.darla.log("succesfully renderd csc for prefetched ads!")});C.renderContent(H,F(),A);YAHOO.ads.darla._prefetchStore=null},sendBeacon:function(action,delay){if(delay===true){delay=YAHOO.ads.darla.getConfigSetting("beaconDelay")}if(typeof delay=="number"&&delay>0){setTimeout("YAHOO.ads.darla.sendBeacon( '"+action+"', null )",delay);return }var spaceid=YAHOO.ads.darla.lookupSpaceID(action);if((spaceid==null)||(spaceid=="undefined")||(spaceid=="null")){return }var url=YAHOO.ads.darla._getBeaconUrl(spaceid);if(url==null||url==""){YAHOO.ads.darla.log("ignoring spaceid (no beacon url provided): "+action+"-"+spaceid,true);return }if(YAHOO.ads.darla._beacons==null){YAHOO.ads.darla._beacons=[]}var id=new Date().getTime();while(YAHOO.ads.darla._beacons["x"+id]!=null){--id}id="x"+id;var beacon=new Image();YAHOO.ads.darla._beacons[id]=beacon;beacon.onload=function(){eval("'onload'; YAHOO.ads.darla._beacons['"+id+"']=null;this.onload = null; this.onerror = null; YAHOO.ads.darla._throbberHack( true );")};beacon.onerror=function(){eval("'onerror'; YAHOO.ads.darla._beacons['"+id+"']=null;this.onload = null; this.onerror = null; YAHOO.ads.darla._throbberHack( true );")};beacon.src=url;YAHOO.ads.darla.log("beaconing spaceid: "+action+" - "+spaceid)},stallAdRequest:function(A){if((YAHOO.ads.darla._config==null)||(YAHOO.ads.darla._lastEvent==null)){return }if(A==null){A=YAHOO.ads.darla.getConfigSetting("cancellableDelay")}if(A==null){return }YAHOO.ads.darla._startEventTimer(YAHOO.ads.darla._lastEvent,A);YAHOO.ads.darla.log("Stalling outstanding ad event",true)},lookupSpaceID:function(C,A){if(YAHOO.ads.darla._config==null){return null}var D=YAHOO.ads.darla._config.events[C];if(D==null){return null}var B=D.sp;if(A){return B}if(B==null){return null}if(YAHOO.ads.darla._config.spaceIdOffset==null){YAHOO.ads.darla._config.spaceIdOffset=0}return((B-0)+(YAHOO.ads.darla._config.spaceIdOffset-0))},overrideSpaceID:function(B,A){if(YAHOO.ads.darla._config==null){return false}var C=YAHOO.ads.darla._config.events[B];if(C==null){return false}C.sp=A;return true},lookupActionSettings:function(D,F){if(YAHOO.ads.darla._config==null){return F}var A={};var E=YAHOO.ads.darla._config.events["default"];if(E!=null){for(var C in E){A[C]=E[C]}}var E=YAHOO.ads.darla._config.events[D];if(E!=null){for(var C in E){A[C]=E[C]}}if(F!=null){for(var C in F){A[C]=F[C]}if(F.sp){YAHOO.ads.darla.overrideSpaceID(D,F.sp)}}A.sp=YAHOO.ads.darla.lookupSpaceID(D);if(YAHOO.ads.darla._config.levelOverride!=null){A.lv=YAHOO.ads.darla._config.levelOverride}if(YAHOO.ads.darla._config.events[D]==-1){result.lv=-1}A=YAHOO.ads.darla._preparePositionString(A);if(YAHOO.ads.darla._config.verboseLogging){var B="";for(var C in A){B+=C+":"+A[C]+"; "}YAHOO.ads.darla.log("computed action settings: "+D+" - "+B,true)}return A},_preparePositionString:function(F){var G=F.ps;if(G==null){return""}var E=[];var C=G.split(",");for(var D=0;D<C.length;++D){var B=C[D];var A=YAHOO.ads.darla._config.destinationMap[B];if(!A||A==""){F.inlineRenderPos=B}if(typeof A=="object"){E[E.length]="n"+A.length+B}else{E[E.length]=B}}F.psStr=E.join(",");return F},getConfigSetting:function(A,B){var C=null;if(YAHOO.ads.darla._config){C=YAHOO.ads.darla._config[A]}if(B||(C===null)){return C}if(C==null){return YAHOO.ads.darla._baseConfig[A]}return C},getTemplate:function(A){var D=YAHOO.ads.darla._config;if(D==null||D.templates==null||D.templates[A]==null){return null}var C=document.getElementById(A);if(C==null||C.tagName.toLowerCase()!="iframe"){return null}var B=[];if(D.templatePrefix!==null){B[B.length]=D.templatePrefix;if(YAHOO.ads.util._isIE){B[B.length-1]=B[B.length-1].replace(new RegExp("<base href=.*?>","i"),"")}}B[B.length]=D.templates[A];if(D.templatePostfix!==null){B[B.length]=D.templatePostfix}return B.join("")},fillSimpleTemplate:function(G,A){var C=YAHOO.ads.darla.getConfigSetting("simpleTemplate");if((C==null)||(C=="")){return null}var F=YAHOO.ads.darla.getConfigSetting("encoding");if((F!=null)&&(F!="")){var E=YAHOO.ads.darla.getConfigSetting("simpleTemplateEncodingTag");if(E){E=E.replace(new RegExp("__ENCODING__","g"),F);C=C.replace(new RegExp("<!--ENCODING-->","g"),E)}}var F=YAHOO.ads.darla.getConfigSetting("bg");if((F!=null)&&(F!="")){var E=YAHOO.ads.darla.getConfigSetting("simpleTemplateStyleTag");if(E){E=E.replace(new RegExp("__BGCOLOR__","g"),F);C=C.replace(new RegExp("<!--STYLE-->","g"),E)}}var B="<!--ADHTML-->";var D=C.indexOf(B);if(D!==-1){C=[C.substring(0,D),A,C.substring(D+B.length)].join("")}YAHOO.ads.darla.log("built from simple template: "+C,true);return C},log:function(B,A){if(YAHOO.ads.darla._config==null||YAHOO.ads.darla._config.log==null){return }if(A&&YAHOO.ads.darla._config.verboseLogging!=true){return }if(B==null){B="null"}var C;try{YAHOO.ads.darla._config.log(B)}catch(C){}},_startEventTimer:function(A,C){if(YAHOO.ads.darla._eventTimer!=null){clearTimeout();YAHOO.ads.darla._eventTimer=null}if(A==null){return }var B=(C!=null)?C:(A.settings.ca?YAHOO.ads.darla.getConfigSetting("cancellableDelay"):YAHOO.ads.darla.getConfigSetting("standardDelay"));YAHOO.ads.darla._lastEvent=A;YAHOO.ads.darla._eventTimer=setTimeout("YAHOO.ads.darla._processEvent('"+A.action+"')",B)},_processEvent:function(B){YAHOO.ads.darla.log("YAHOO.ads.darla._processEvent firing for action: "+B);YAHOO.ads.darla._eventTimer=null;if(YAHOO.ads.darla._config==null){return }if(YAHOO.ads.darla._lastEvent==null||YAHOO.ads.darla._lastEvent.action!=B){return null}YAHOO.ads.darla._recordEvent();var A=YAHOO.ads.darla._lastEvent.settings;var C=A.lv;if(C==null){C=(A.sp!=null)?1:-1}if(C<0){if(YAHOO.ads.darla.getConfigSetting("autoRotation")){C=1}else{return }}if(C>1){YAHOO.ads.darla._clearRotationTimer();C=1}if((C==1)&&YAHOO.ads.darla._checkRotation(A.ro)){if(YAHOO.ads.darla._call(B,A)==true){return }}if(YAHOO.ads.darla.getConfigSetting("beaconsDisabled")!=true){YAHOO.ads.darla.sendBeacon(B,YAHOO.ads.darla.getConfigSetting("beaconDelay"))}},_recordEvent:function(){if(YAHOO.ads.darla.getConfigSetting("autoRotation")){var B=YAHOO.ads.darla.getConfigSetting("autoRotationWindow");var A=YAHOO.ads.darla.getConfigSetting("rotation");if(B==null||B>A){B=A}if((YAHOO.ads.darla._rotationTime==0)||((new Date()).getTime()-YAHOO.ads.darla._rotationTime)>(A-B)){YAHOO.ads.darla._rotationEvents=true}}},_call:function(I,G){if(YAHOO.ads.darla._config==null){return }var D=YAHOO.ads.darla._config;if(D.callFrame==null){YAHOO.ads.darla.log("YAHOO.ads.darla._call called, but no call iframe specified.",true);return }var F;if(G.callFrame==null){F=document.getElementById(YAHOO.ads.darla.getConfigSetting("callFrame"))}else{F=document.getElementById(G.callFrame)}YAHOO.ads.darla.log("callFrame specified: "+F.id,true);if(F==null){YAHOO.ads.darla.log("YAHOO.ads.darla._call called, but call iframe not found, id: "+D.callFrame,true);return }var L=G.sp;if(L==null||L==""){YAHOO.ads.darla.log("YAHOO.ads.darla._call called, but null space ID found; the action was: "+I,true);return false}var K=G.psStr;if(K==""){YAHOO.ads.darla._clearRotationTimer();YAHOO.ads.darla.log("YAHOO.ads.darla._call called, but no positions to update; the action was: "+I,true);return false}var N=G.em;if(N==null){N=D.extraMime}var M=G.bg;if(M==null){M=""}YAHOO.ads.darla._handoffStore=null;var A=YAHOO.ads.darla.getConfigSetting("mb_source_encoding");var E=YAHOO.ads.darla.getConfigSetting("indirect_render_pos");var C=YAHOO.ads.darla.adgroup;var B=[YAHOO.ads.darla.getConfigSetting("callScript")+"?cb=YAHOO.ads.darla._loaded"];B[B.length]="p="+YAHOO.ads.darla.getConfigSetting("property");B[B.length]="f="+L;B[B.length]="l="+K;B[B.length]="en="+YAHOO.ads.darla.getConfigSetting("encoding");if(G.npv){B[B.length]="npv=1"}if(A&&A!=null){B[B.length]="mb_s_en="+A}if(E&&typeof (E)=="object"){B[B.length]="indirect="+E.join(",")}B[B.length]="rn="+(new Date().getTime());if(C){B[B.length]="adgroup="+encodeURIComponent(C)}if(G.inlineRenderPos&&G.inlineRenderPos!=""){B[B.length]="inlinePos="+G.inlineRenderPos}if(N!=null){B[B.length]="em="+N}if(D.target){B[B.length]="tgt="+D.target}if(D.domain){B[B.length]="dm="+D.domain}if(G.op){var H=G.op;for(var J in H){B[B.length]=J+"="+H[J]}}if(D.otherParams){var H=D.otherParams;for(var J in H){if(G.op&&G.op[J]){continue}B[B.length]=J+"="+H[J]}}B=B.join("&");YAHOO.ads.darla.log("ad request: "+I+"; url="+B);YAHOO.ads.util.replaceIframe(F,B);return true},_startRotationTimer:function(A){if(YAHOO.ads.darla._config==null){return }YAHOO.ads.darla._clearRotationTimer();YAHOO.ads.darla._rotationEvents=false;YAHOO.ads.darla._rotationTime=(new Date()).getTime();if(YAHOO.ads.darla.getConfigSetting("autoRotation")){if(A==null){A=YAHOO.ads.darla.getConfigSetting("rotation")}if(A==null){return }YAHOO.ads.darla._rotationTimer=setTimeout("YAHOO.ads.darla._rotateAdState()",A);YAHOO.ads.darla.log("start ad timer: "+A,true)}},_clearRotationTimer:function(){YAHOO.ads.darla._rotationTime=0;if(YAHOO.ads.darla._rotationTimer!=null){clearTimeout(YAHOO.ads.darla._rotationTimer);YAHOO.ads.darla._rotationTimer=null}},_rotateAdState:function(){YAHOO.ads.darla._clearRotationTimer();if(YAHOO.ads.darla.getConfigSetting("autoRotation")&&YAHOO.ads.darla._rotationEvents){YAHOO.ads.darla.event("default")}YAHOO.ads.darla._rotationEvents=false},_checkRotation:function(A){if(YAHOO.ads.darla._config==null){return false}if(YAHOO.ads.darla._rotationTime==0){return true}if(A==null){A=YAHOO.ads.darla.getConfigSetting("rotation")}return(YAHOO.ads.darla._rotationTime+A<=(new Date().getTime()))},_throbberHack:function(A){if((YAHOO.ads.darla._config==null)||(typeof YAHOO.ads.darla._config.throbberHack!="function")){return }if(A===true){A=YAHOO.ads.darla.getConfigSetting("throbberDelay")}if(typeof A=="number"&&A>0){if(YAHOO.ads.darla._throbTimer!=null){clearTimeout(YAHOO.ads.darla._throbTimer)}YAHOO.ads.darla._throbTimer=setTimeout("YAHOO.ads.darla._throbberHack()",A);return }if(typeof YAHOO.ads.darla._config.throbberHack=="function"){YAHOO.ads.darla.log("letting loose the throbber hack",true);YAHOO.ads.darla._config.throbberHack()}},_getBeaconUrl:function(C){var B=YAHOO.ads.darla.getConfigSetting("beaconType");if(B=="geo"){var A=YAHOO.ads.darla.getConfigSetting("beaconUrl")+C}else{var A=[YAHOO.ads.darla.getConfigSetting("callScript")+"?pvcsc=true"];A[A.length]="p="+YAHOO.ads.darla.getConfigSetting("property");A[A.length]="f="+C;A[A.length]="l=Z";A=A.join("&")}if((A==null)||(A=="")){return null}return A+"&t="+Math.random()},renderHandoffs:function(A){if(YAHOO.ads.darla._handoffStore!=null){if(YAHOO.ads.darla._lastEvent){YAHOO.ads.darla.log("rendering request: '"+YAHOO.ads.darla._lastEvent.settings.ps+"'")}YAHOO.ads.darla._renderStore={};for(var C in YAHOO.ads.darla._handoffStore){var D=YAHOO.ads.darla._config.destinationMap[C];YAHOO.ads.darla.log("found ad in handoff store: "+C);switch(typeof D){case"string":YAHOO.ads.darla._updateTemplate(C,0,D);break;case"object":for(var B=0;B<D.length;++B){YAHOO.ads.darla._updateTemplate(C,B,D[B])}break}}for(var C in YAHOO.ads.darla._renderStore){YAHOO.ads.darla._renderTemplate(C)}}},_updateTemplate:function(F,B,A){var D=YAHOO.ads.darla._handoffStore[F][B];if(D==null){return }if(YAHOO.ads.darla._renderStore[A]==null){var C=YAHOO.ads.darla.getTemplate(A);if((C==null)||(C=="")){var E=document.getElementById(A);if(E&&E.tagName.toLowerCase()=="iframe"){var C=YAHOO.ads.darla.fillSimpleTemplate(F,D)}if(C!=null){YAHOO.ads.darla._renderStore[A]=C;return }YAHOO.ads.darla._renderStore[A]=D;return }YAHOO.ads.darla._renderStore[A]=C;YAHOO.ads.darla.log("template found: "+F+"->"+A+": "+C,true)}var C=YAHOO.ads.darla._renderStore[A];YAHOO.ads.darla._renderStore[A]=C.replace(new RegExp("<!--"+F+"-->",""),D)},_renderTemplate:function(B){var C=null;if(YAHOO.ads.darla.getConfigSetting("doubleBuffering")){C=document.getElementById(B+"_")}if(!C){C=document.getElementById(B)}var A=YAHOO.ads.darla._renderStore[B];YAHOO.ads.darla._renderAdThroughConfiguredRenderer(A,C)},_renderAdThroughConfiguredRenderer:function(E,A){var D=YAHOO.ads.darla.getConfigSetting("renderer");if(!D){try{D=YAHOO.ads.renderer.ComplexRenderer;if(!D){throw"Couldn't find default renderer!"}}catch(C){YAHOO.ads.darla.log("Error: Couldn't find a renderer for Darla!");return }}var B=YAHOO.ads.darla._fetchRendererOptions();D.registerPostRenderCallback(this,YAHOO.ads.darla._postRenderHandler);try{D.renderContent(E,A,B)}catch(C){YAHOO.ads.darla.log("Error occured while rendering the ad: "+C.message)}},_fetchRendererOptions:function(){var A={en:YAHOO.ads.darla.getConfigSetting("encoding")};var B=YAHOO.ads.darla.getConfigSetting("rendererOptions");if(A){for(var C in B){A[C]=B[C]}}return A},_postRenderHandler:function(A){YAHOO.ads.darla._swapForDoubleBuffering(A)},_blankIframe:function(A){if(typeof A=="string"){A=document.getElementById(A)}if((A==null)||(A.tagName.toLowerCase()!="iframe")){return }YAHOO.ads.util.replaceIframe(A,YAHOO.ads.util._isIE?"javascript:'<html></html>'":"about:blank")},_swapElements:function(A){function C(G){var F=document.getElementById(G+"_");var E=document.getElementById(G);if(F==null||E==null){return }F.id=G;F.style.display="block";F.style.visibility="visible";E.id=G+"_";E.style.display="none";if(E.tagName.toLowerCase()=="iframe"){YAHOO.ads.darla._blankIframe(E)}else{E.innerHTML=""}}YAHOO.ads.darla.log("swapping positions: "+A,true);var D=A.split(",");for(var B=0;B<D.length;++B){C(D[B])}YAHOO.ads.darla._throbberHack(true)},_swapForDoubleBuffering:function(A){var C=null;if(A.id){C=A.id}var B=document.getElementById(C);YAHOO.ads.darla.log("frame loaded: "+C,true);if(YAHOO.ads.darla.getConfigSetting("doubleBuffering")&&C.charAt(C.length-1)=="_"){YAHOO.ads.darla._swapElements(C.substring(0,C.length-1))}},_loaded:function(B,A){if(A!=null){YAHOO.ads.darla.log("calling through to _handoff");return YAHOO.ads.darla._handoff(B,A)}YAHOO.ads.darla.log("ads returned: '"+B+"'");YAHOO.ads.darla.renderHandoffs(B);YAHOO.ads.darla._startRotationTimer();if(YAHOO.ads.darla._config&&YAHOO.ads.darla._config.finish){YAHOO.ads.darla._config.finish(B)}},_handoff:function(B,A){YAHOO.ads.darla.log("ad hand-off: "+B+" - "+A);if(YAHOO.ads.darla._handoffStore==null){YAHOO.ads.darla._handoffStore={}}if(YAHOO.ads.darla._handoffStore[B]==null){YAHOO.ads.darla._handoffStore[B]=[]}var C=YAHOO.ads.darla._handoffStore[B];C[C.length]=A;return true},_prefetch:function(B,A,D){YAHOO.ads.darla.log("prefetching ad: "+B+" - "+A);if(YAHOO.ads.darla._prefetchStore==null){YAHOO.ads.darla._prefetchStore={}}if(YAHOO.ads.darla._prefetchStore[B]==null){YAHOO.ads.darla._prefetchStore[B]=[]}var C=YAHOO.ads.darla._prefetchStore[B];C[C.length]={adHtml:A,csc:D}}};if(typeof YAHOO==="undefined"){var YAHOO={}}if(typeof YAHOO.ads==="undefined"){YAHOO.ads={}}if(typeof YAHOO.ads.util==="undefined"){YAHOO.ads.util={}}YAHOO.ads.util=function(){return{_isIE:(!navigator.userAgent.match(/AppleWebKit\/([^ ]*)/)&&!navigator.userAgent.match(/opera/gi)&&navigator.userAgent.match(/msie/gi)),replaceIframe:function(G,A,H){if(!YAHOO.ads.util._isIE){if(H){G.onload=H}if(G.contentWindow==null){G.src=A}else{G.contentWindow.location.replace(A)}return G}var E;try{if(G.contentWindow&&G.contentWindow.Unloader){G.contentWindow.Unloader.fire()}}catch(E){}var B=document.createElement("iframe");var F=G.attributes;if(F==null){F=[]}var C=F.length;if(!A){A=G.getAttribute("src")}for(var D=0;D<C;++D){var J=F[D].nodeName;var I=F[D].nodeValue;switch(J.toLowerCase()){case"style":continue;case"src":I=A;break}if(!I){continue}B.setAttribute(J,I)}if(A&&A.length>0&&!B.getAttribute("src")){B.setAttribute("src",A)}if(H){B.onload=H;if(B.attachEvent){B.attachEvent("onload",H)}}if(YAHOO.ads.util._isIE&&G.className){B.className=G.className}B.style.cssText=G.style.cssText;try{if(G.contentWindow.document.readyState=="complete"){YAHOO.ads.darla.log("replacing iframe immediately: "+G.id);G.parentNode.replaceChild(B,G);return B}}catch(E){}if(YAHOO.ads.util.replaceIframe.killCount==null){YAHOO.ads.util.replaceIframe.killCount=0}G.id="killMeNow"+YAHOO.ads.util.replaceIframe.killCount++;G.style.display="none";G.parentNode.insertBefore(B,G);setTimeout("YAHOO.ads.util.deleteIframeWhenLoaded('"+G.id+"')",250);try{YAHOO.ads.darla.log("timing out to delete incomplete iframe: "+G.id+" with readyState: "+G.contentWindow.document.readyState)}catch(E){YAHOO.ads.darla.log("timing out to delete incomplete iframe: "+G.id+" - couldn't access iframe readyState")}return B},deleteIframeWhenLoaded:function(D,A){if(A==null){A=0}var B=document.getElementById(D);if(B){var C;try{if(A>10||B.contentWindow.document.readyState=="complete"){YAHOO.ads.darla.log("deleting replaced iframe: "+B.id);B.parentNode.removeChild(B)}else{YAHOO.ads.darla.log("retrying to delete iframe: "+B.id);setTimeout("YAHOO.ads.util.deleteIframeWhenLoaded('"+D+"',"+(A+1)+")",1000)}}catch(C){try{if(B.parentNode){B.parentNode.removeChild(B)}}catch(C){}}}}}}();if(typeof YAHOO==="undefined"){var YAHOO={}}if(typeof YAHOO.ads==="undefined"){YAHOO.ads={}}if(typeof YAHOO.ads.renderer==="undefined"){YAHOO.ads.renderer={}}YAHOO.ads.renderer.ComplexRenderer=function(){var _renderMap=[];var _renderIndex=1;var _defaultMiniDocUrl="/darla/md.php";var _subscriberObject;var _subscriber;function _appendToRenderMap(content,frameElement,subscriber,subscriberObject){var currentIndex=_renderIndex;_renderMap[currentIndex]={content:content,frameElement:frameElement,subscriber:subscriber,subscriberObject:subscriberObject};_renderIndex=_renderIndex+1;if(_renderIndex>10){_renderIndex=1}return currentIndex}function _renderThroughMiniDoc(htmlContent,frameElement,configObject){var domainHint=configObject.dh;var mdURL=configObject.mdUrl||_defaultMiniDocUrl;var miniDocUrl=mdURL+"?en="+configObject.en;if(domainHint){miniDocUrl+="&dh="+domainHint}var contentId=_appendToRenderMap(htmlContent,frameElement,_subscriber,_subscriberObject);frameElement.setAttribute("contentId",contentId);YAHOO.ads.util.replaceIframe(frameElement,miniDocUrl,_triggerParentHandler)}function _triggerParentHandler(){var srcElementId=this.id||event.srcElement.id;var srcElement=document.getElementById(srcElementId);var contentId=srcElement.getAttribute("contentId");if(contentId){var frameElement=document.getElementById(srcElement.id);_unsubscribeOnRenderHandlers(frameElement);var renderContext=_renderMap[contentId];if(renderContext.subscriber&&renderContext.subscriberObject){renderContext.subscriber.call(renderContext.subscriberObject,frameElement)}}else{_subscriber.call(_subscriberObject,srcElement)}}function _unsubscribeOnRenderHandlers(element){if(element.tagName&&element.tagName.toLowerCase()=="iframe"){if(element.onload==_triggerParentHandler){element.onload=null}else{if(element.detachEvent){element.detachEvent("onload",_triggerParentHandler)}}}}YAHOO.ads.renderer.ComplexScriptRenderer={_iframeTag:new RegExp(/(<iframe[^>]*>)([\s]|[^\s])*?(<\/iframe>)/igm),_noscriptTag:new RegExp(/<noscript[^>]*>([\s]|[^\s])*?<\/noscript>/igm),_scriptTag:new RegExp(/<script[^>]*>(([\s]|[^\s])*?)<\/script>/im),_externalScript:new RegExp(/^\s*<script[^>]* src=([^\s>]*)>([\s]|[^\s])*?<\/script>/im),_vbScript:new RegExp(/<script[^>]* language=['"]?VBScript([^\s>]*)>([\s]|[^\s])*?<\/script>/im),_quotedString:new RegExp(/^('|")(.*)('|")$/),_htmlComment:new RegExp(/\s*<!--(([\s]|[^\s])*)\/\/\s*-->\s*/m),_extAdCallURL:new RegExp(/^http[s]?:\/\/[A-Za-z0-9_.]*adserver.yahoo.com\//i),_rendered:{},_handoffs:{},renderHandoffs:function(htmlContent,dest){dest=dest.id;YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest]=htmlContent;YAHOO.ads.renderer.ComplexScriptRenderer._continueHandoffs(dest)},_continueHandoffs:function(dest){YAHOO.ads.renderer.ComplexScriptRenderer._setupRender();if(YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest]!=null){var html=YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest];html=html.replace(YAHOO.ads.renderer.ComplexScriptRenderer._iframeTag,"$1</iframe>");html=html.replace(YAHOO.ads.renderer.ComplexScriptRenderer._noscriptTag,"");YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest]=html;if(!YAHOO.ads.renderer.ComplexScriptRenderer._render1Handoff(dest)){return}}YAHOO.ads.renderer.ComplexScriptRenderer._finishRender(dest)},_render1Handoff:function(dest,continuing){function _continue1ExternalRender(){if(YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest]==null){return}YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest]=YAHOO.ads.renderer.ComplexScriptRenderer._insertWriteStore(YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest]);YAHOO.ads.renderer.ComplexScriptRenderer._render1Handoff(dest,true);if(YAHOO.ads.util._isIE){YAHOO.ads.renderer.ComplexScriptRenderer.externalScriptLoadManager.deQueue()}}if(!continuing){YAHOO.ads.renderer.ComplexScriptRenderer._scriptCount=0}var html=YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest];var match=html.match(YAHOO.ads.renderer.ComplexScriptRenderer._scriptTag);while(match){YAHOO.ads.renderer.ComplexScriptRenderer._scriptCount+=1;if(YAHOO.ads.renderer.ComplexScriptRenderer._scriptCount>10){break}var ematch=match[0].match(YAHOO.ads.renderer.ComplexScriptRenderer._externalScript);if(ematch&&ematch[1]){var qmatch=ematch[1].match(YAHOO.ads.renderer.ComplexScriptRenderer._quotedString);if(qmatch&&qmatch[2]){ematch[1]=qmatch[2]}var shouldBustCache=(ematch[1].match(YAHOO.ads.renderer.ComplexScriptRenderer._extAdCallURL)!==null);var loadRequest={id:"external_script"+dest,url:ematch[1],callback:_continue1ExternalRender,bustCache:shouldBustCache};if(YAHOO.ads.util._isIE){YAHOO.ads.renderer.ComplexScriptRenderer.externalScriptLoadManager.enQueue(loadRequest)}else{YAHOO.ads.renderer.ComplexScriptRenderer.loadScriptFile(loadRequest.id,loadRequest.url,loadRequest.callback,null,null,loadRequest.bustCache,true)}return false}if(match[1]){var isVB=false;var hmatch=match[0].match(YAHOO.ads.renderer.ComplexScriptRenderer._vbScript);if(hmatch&&hmatch[0]){isVB=true}var hmatch=match[1].match(YAHOO.ads.renderer.ComplexScriptRenderer._htmlComment);if(hmatch&&hmatch[1]){match[1]=hmatch[1]}try{if(isVB){ExecuteVBS(match[1])}else{if(window.execScript){window.execScript(match[1])}else{window.eval(match[1])}}}catch(e){}YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest]=html=YAHOO.ads.renderer.ComplexScriptRenderer._insertWriteStore(html)}match=html.match(YAHOO.ads.renderer.ComplexScriptRenderer._scriptTag)}YAHOO.ads.renderer.ComplexScriptRenderer._rendered[dest]=YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest];delete YAHOO.ads.renderer.ComplexScriptRenderer._handoffs[dest];YAHOO.ads.renderer.ComplexScriptRenderer._scriptCount=0;if(continuing){YAHOO.ads.renderer.ComplexScriptRenderer._continueHandoffs(dest)}else{return true}},_insertWriteStore:function(s){if(!s){return}if(YAHOO.ads.renderer.ComplexScriptRenderer._writeStore==null){YAHOO.ads.renderer.ComplexScriptRenderer._writeStore=[""]}var i=s.search(YAHOO.ads.renderer.ComplexScriptRenderer._scriptTag);s=s.replace(YAHOO.ads.renderer.ComplexScriptRenderer._scriptTag,"");s=s.slice(0,i)+YAHOO.ads.renderer.ComplexScriptRenderer._writeStore.join("")+s.slice(i);YAHOO.ads.renderer.ComplexScriptRenderer._writeStore=null;return s},_setupRender:function(){if(document.write!=YAHOO.ads.renderer.ComplexScriptRenderer._write){YAHOO.ads.renderer.ComplexScriptRenderer._write_old_=document.write;document.write=YAHOO.ads.renderer.ComplexScriptRenderer._write}if(document.writeln!=YAHOO.ads.renderer.ComplexScriptRenderer._writeln){document._writeln_old_=document.writeln;document.writeln=YAHOO.ads.renderer.ComplexScriptRenderer._writeln}},_write:function(s){if(YAHOO.ads.renderer.ComplexScriptRenderer._writeStore==null){YAHOO.ads.renderer.ComplexScriptRenderer._writeStore=[]}YAHOO.ads.renderer.ComplexScriptRenderer._writeStore[YAHOO.ads.renderer.ComplexScriptRenderer._writeStore.length]=s;if(s.search(/<\/script>/i)>-1){s=YAHOO.ads.renderer.ComplexScriptRenderer._writeStore.join("");var match=s.match(YAHOO.ads.renderer.ComplexScriptRenderer._externalScript);if(match&&match[1]){return}var match=s.match(YAHOO.ads.renderer.ComplexScriptRenderer._scriptTag);if(match&&match[1]){if(match[1].search(/document.write/i)>-1){return}var isVB=false;var hmatch=match[0].match(YAHOO.ads.renderer.ComplexScriptRenderer._vbScript);if(hmatch&&hmatch[0]){isVB=true}var hmatch=match[1].match(YAHOO.ads.renderer.ComplexScriptRenderer._htmlComment);if(hmatch&&hmatch[1]){match[1]=hmatch[1]}try{if(isVB){ExecuteVBS(match[1])}else{if(window.execScript){window.execScript(match[1])}else{window.eval(match[1])}}}catch(e){}YAHOO.ads.renderer.ComplexScriptRenderer._writeStore=[s.replace(YAHOO.ads.renderer.ComplexScriptRenderer._scriptTag,"")]}}},_writeln:function(s){YAHOO.ads.renderer.ComplexScriptRenderer._write(s+"\n")},_finishRender:function(dest){if(YAHOO.ads.renderer.ComplexScriptRenderer._rendered==null){YAHOO.ads.renderer.ComplexScriptRenderer._rendered={}}if(YAHOO.ads.renderer.ComplexScriptRenderer._rendered[dest]!=null){var dst=document.getElementById(dest);if(dst){dst.innerHTML=YAHOO.ads.renderer.ComplexScriptRenderer._rendered[dest]}delete YAHOO.ads.renderer.ComplexScriptRenderer._rendered[dest]}YAHOO.ads.renderer.ComplexScriptRenderer._rendered={};_triggerParentHandler.call(dst)},externalScriptLoadManager:(function(){var loadRequests=new Array();function loadFile(loadRequest){YAHOO.ads.renderer.ComplexScriptRenderer.loadScriptFile(loadRequest.id,loadRequest.url,loadRequest.callback,null,null,loadRequest.bustCache,true)}return{enQueue:function(loadRequest){if(loadRequests.length==0){loadFile(loadRequest)}loadRequests[loadRequests.length]=loadRequest;return loadRequests.length},deQueue:function(){loadRequests.splice(0,1);if(loadRequests.length>0){loadFile(loadRequests[0])}}}})(),loadScriptFile:function(id,url,callbackfn,encoding,theWindow,bustTheCache,forceAReload){if(typeof theWindow=="undefined"||theWindow==null){theWindow=window}if(YAHOO.ads.renderer.ComplexScriptRenderer.loadScriptFile._loadingIDs==null){YAHOO.ads.renderer.ComplexScriptRenderer.loadScriptFile._loadingIDs={}}if(!forceAReload&&id!=null&&id!=""){if(YAHOO.ads.renderer.ComplexScriptRenderer.loadScriptFile._loadingIDs[id]){return true}}var e;try{var old=theWindow.document.getElementById(id);if(old){old.parentNode.removeChild(old)}var newTag=theWindow.document.createElement("script");newTag.setAttribute("type","text/javascript");if(bustTheCache){var urlArgPos=url.indexOf("?");if(urlArgPos==-1){url+="?cgicbs="+(new Date().getTime()+Math.random())}else{url=url.substring(0,urlArgPos+1)+"cgicbs="+(new Date().getTime()+Math.random())+"&"+url.substring(urlArgPos+1)}}newTag.setAttribute("src",url);newTag.setAttribute("charset",encoding?encoding:"utf-8");newTag.setAttribute("id",id);var callCallback=function(){if(id!=null&&id!=""){YAHOO.ads.renderer.ComplexScriptRenderer.loadScriptFile._loadingIDs[id]=null}if(window.Activity){Activity.updateTime(Activity.JS)}if(callbackfn==null){return}if(typeof callbackfn=="string"){var path=callbackfn.split(".");var arg=theWindow;for(var k=0;k<path.length&&(arg!=null);++k){arg=arg[path[k]]}callbackfn=arg}if(typeof callbackfn=="function"){callbackfn()}};var iefunc=function(){if(this.readyState=="loaded"||this.readyState=="complete"){callCallback();this.onreadystatechange=null}};if(YAHOO.ads.util._isIE){newTag.onreadystatechange=iefunc}else{newTag.onload=callCallback}if(id!=null&&id!=""){YAHOO.ads.renderer.ComplexScriptRenderer.loadScriptFile._loadingIDs[id]=true}YAHOO.ads.renderer.ComplexScriptRenderer.getHeadElement(theWindow.document).appendChild(newTag);if(window.Activity){Activity.updateTime(Activity.JS,true,url)}}catch(e){return false}return true},getHeadElement:function(doc){if(doc==null){doc=document}var e=doc.getElementsByTagName("head");if(e.length==0){var h=doc.createElement("head");doc.documentElement.insertBefore(h,doc.body);e=doc.getElementsByTagName("head")}return e[0]}};return{renderContent:function(htmlContent,destination,configObject){if(!destination||!destination.tagName){throw {message:"Destination should be a valid html element!"}}if(destination.tagName.toLowerCase()=="iframe"){_renderThroughMiniDoc(htmlContent,destination,configObject)}else{YAHOO.ads.renderer.ComplexScriptRenderer.renderHandoffs(htmlContent,destination)}},registerPostRenderCallback:function(object,subscriber){_subscriberObject=object;_subscriber=subscriber},fetchContentForMiniDoc:function(renderIndex){if(renderIndex!=null){return _renderMap[renderIndex].content}}}}();